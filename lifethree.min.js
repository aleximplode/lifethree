// lifethree - 2014-01-20
(function(){$(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;for(z=window.innerWidth,n=window.innerHeight,h=40,u=40,y=1.5,b=16777215,v=new THREE.Scene,e=new THREE.PerspectiveCamera(75,z/n,.1,1e3),s=new THREE.WebGLRenderer,s.setSize(z,n),s.setClearColor(new THREE.Color(b)),v.add(e),d=function(){var a,b,c;for(c=[],B=a=0,b=u-1;b>=0?b>=a:a>=b;B=b>=0?++a:--a)c.push(function(){var a,b,c;for(c=[],B=a=0,b=h-1;b>=0?b>=a:a>=b;B=b>=0?++a:--a)c.push(null);return c}());return c}(),w=THREE.ImageUtils.loadTexture("textures/box.png"),x=THREE.ImageUtils.loadTexture("textures/boxfull.png"),l=new THREE.CubeGeometry(1,1,1),o=new THREE.MeshLambertMaterial({color:16777215,map:w}),p=new THREE.MeshLambertMaterial({color:16777215,map:x}),A=new THREE.Object3D,c=new THREE.Object3D,c.position.z=-25,A.add(c),v.add(A),t=C=0,E=u-1;E>=0?E>=C:C>=E;t=E>=0?++C:--C)for(g=D=0,F=h-1;F>=0?F>=D:D>=F;g=F>=0?++D:--D)j=new THREE.Mesh(l,o),c.add(j),j.position.set(h*-.5+g,u*-.5+t,0),d[t][g]=j;return f=function(){var a,b,c;for(c=[],B=a=0,b=u-1;b>=0?b>=a:a>=b;B=b>=0?++a:--a)c.push(function(){var a,b,c;for(c=[],B=a=0,b=h-1;b>=0?b>=a:a>=b;B=b>=0?++a:--a)c.push(0);return c}());return c}(),f[3][6]=1,f[4][7]=1,f[5][5]=1,f[5][6]=1,f[5][7]=1,k=new THREE.DirectionalLight(16777215,.5),k.position.set(0,1,5),v.add(k),a=new THREE.AmbientLight(10066329),v.add(a),e.position.z=5,m=function(a,b,c){var d,e;return d=c,e=b,0>c?d=h+c:c>=h&&(d=c%h),0>b?e=u+b:b>=u&&(e=b%u),a[e][d]},i=function(a,b,c){return m(a,c-1,b-1)+m(a,c,b-1)+m(a,c+1,b-1)+m(a,c-1,b)+m(a,c+1,b)+m(a,c-1,b+1)+m(a,c,b+1)+m(a,c+1,b+1)},q=function(a){var b,c,d,e,f;for(c=$.map(a,function(a){return[a.slice()]}),f=[],t=d=0,e=u-1;e>=0?e>=d:d>=e;t=e>=0?++d:--d)f.push(function(){var d,e,f;for(f=[],g=d=0,e=h-1;e>=0?e>=d:d>=e;g=e>=0?++d:--d)b=i(c,g,t),f.push(1===c[t][g]?2>b?a[t][g]=0:b>=2&&3>=b?this:b>3?a[t][g]=0:void 0:3===b?a[t][g]=1:void 0);return f}.call(this));return f},document.body.appendChild(s.domElement),(r=function(){var a,b,c,i;for(q(f),t=a=0,c=u-1;c>=0?c>=a:a>=c;t=c>=0?++a:--a)for(g=b=0,i=h-1;i>=0?i>=b:b>=i;g=i>=0?++b:--b)d[t][g].material=1===f[t][g]?p:o;return s.render(v,e),window.requestAnimationFrame(r)})()})}).call(this);